{% extends "_layouts/cp" %}
{% import "_includes/forms" as forms %}

{% set formHandle = form.handle %}

{% block content %}

	<form id="application-form" method="post" accept-charset="UTF-8" data-saveshortcut="1" data-saveshortcut-redirect="{{ continueEditingUrl }}">
		<input type="hidden" name="action" value="applications/saveApplication">
		<input type="hidden" name="redirect" value="applications">
		<input type="hidden" name="formId" value="{{ form.id }}">
		{% if application.id %}
			<input type="hidden" name="applicationId" value="{{ application.id }}">
		{% endif %}
		{% if craft.isLocalized() %}
			<input type="hidden" name="locale" value="{{ application.locale }}">
		{% endif %}

		{{ forms.textField({
			label: "Applicant Name"|t,
			id: 'applicantName',
			name: 'applicantName',
			value: application.applicantName,
			errors: application.getErrors('applicantName'),
			first: true,
			autofocus: true,
			required: true
		}) }}

		{{ forms.textField({
			label: "Applicant Email"|t,
			id: 'applicantEmail',
			name: 'applicantEmail',
			value: application.applicantEmail,
			errors: application.getErrors('applicantEmail'),
			required: true
		}) }}

		{{ forms.dateTimeField({
			label: "Submit Date"|t,
			id: 'submitDate',
			name: 'submitDate',
			value: (entry.submitDate ? entry.submitDate : null),
			errors: entry.getErrors('submitDate'),
			required: true
		}) }}

		{{ forms.checkboxField({
			label: "Agreed To Terms"|t,
			id: "agreedToTerms",
			name: 'agreedToTerms',
			value: application.agreedToTerms,
			errors: application.getErrors('agreedToTerms')
		}) }}

		<hr>

		<div>
			{% for tab in form.getFieldLayout().getTabs() %}
				<div id="tab{{ loop.index }}"{% if not loop.first %} class="hidden"{% endif %}>
					{% include "_includes/fields" with {
						fields: tab.getFields(),
						element: application
					} only %}
				</div>
			{% endfor %}
		</div>

		<div class="buttons">
			<div class="btngroup submit first">
				<input type="submit" class="btn submit" value="{{ 'Save'|t }}">

				<div class="btn submit menubtn"></div>
				<div class="menu">
					<ul>
						<li><a class="formsubmit" data-redirect="{{ continueEditingUrl }}">{{ "Save and continue editing"|t }}</a></li>
						<li><a class="formsubmit" data-redirect="applications/{{ formHandle }}/new">{{ "Save and add another"|t }}</a></li>
					</ul>
				</div>
			</div>

			<input type="button" class="btn formsubmit" value="{{ 'Delete'|t }}" data-action="applications/deleteApplication"
				data-confirm="{{ 'Are you sure you want to delete this application?'|t }}"
				data-redirect="applications">
		</div>
	</form>
{% endblock %}
